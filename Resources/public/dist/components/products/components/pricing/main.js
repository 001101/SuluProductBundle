define([],function(){"use strict";var a="#product-pricing-form",b=60,c=function(){this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/product/template/product/pricing")),i.call(this),f.call(this,this.options.data)},d=function(){this.sandbox.on("sulu.header.toolbar.save",function(){e.call(this)},this),this.sandbox.on("sulu.products.saved",function(){h.call(this,!0)},this),this.sandbox.on("sulu.header.back",function(){this.sandbox.emit("sulu.products.list")},this)},e=function(){if(this.sandbox.form.validate(a)){var b=this.sandbox.form.getData(a);this.sandbox.emit("sulu.products.save",b)}},f=function(b){var c=this.sandbox.form.create(a);c.initialized.then(function(){g.call(this,b),this.sandbox.form.addCollectionFilter(a,"prices",function(a){return""===a.id&&delete a.id,""!==a.price})}.bind(this))},g=function(b){this.sandbox.form.setData(a,b).then(function(){this.sandbox.start(a)}.bind(this)).fail(function(a){this.sandbox.logger.error("An error occured when setting data!",a)}.bind(this))},h=function(a){if(a!==this.saved){var b=this.options.data&&this.options.data.id?"edit":"add";this.sandbox.emit("sulu.header.toolbar.state.change",b,a,!0)}this.saved=a},i=function(){var a="pim.product.title",c=[{title:"navigation.pim"},{title:"pim.products.title"}];this.options.data&&this.options.data.name&&(a=this.options.data.name),a=this.sandbox.util.cropTail(a,b),this.sandbox.emit("sulu.header.set-title",a),c.push(this.options.data&&this.options.data.number?{title:"#"+this.options.data.number}:{title:"pim.product.title"}),this.sandbox.emit("sulu.header.set-breadcrumb",c)},j=function(){this.sandbox.dom.on(a,"change",function(){h.call(this,!1)}.bind(this),"select"),this.sandbox.dom.on(a,"keyup",function(){h.call(this,!1)}.bind(this),"input, textarea"),this.sandbox.on("sulu.content.changed",function(){h.call(this,!1)}.bind(this)),this.sandbox.on("husky.select.tax-class.selected.item",function(){h.call(this,!1)}.bind(this))};return{name:"Sulu Product Pricing View",view:!0,templates:["/admin/product/template/product/pricing"],initialize:function(){d.call(this),c.call(this),j.call(this)}}});