define(["suluproduct/models/product","app-config"],function(a,b){"use strict";var c="sulu.products.",d=c+"new",e=c+"save",f=c+"import",g=c+"list";return{initialize:function(){this.product=null,this.bindCustomEvents(),"list"===this.options.display?this.renderList():"form"===this.options.display?this.renderForm():"import"===this.options.display&&this.renderImport()},bindCustomEvents:function(){this.sandbox.on(d,function(a){this.sandbox.emit("sulu.router.navigate","pim/products/"+b.getUser().locale+"/add/type:"+a)}.bind(this)),this.sandbox.on(e,function(a){this.save(a)}.bind(this)),this.sandbox.on(f,function(){this.sandbox.emit("sulu.router.navigate","pim/products/import")}.bind(this)),this.sandbox.on("husky.datagrid.item.click",function(a){this.load(a,b.getUser().locale)}.bind(this)),this.sandbox.on(g,function(){this.sandbox.emit("sulu.router.navigate","pim/products")}.bind(this)),this.sandbox.on("sulu.header.language-changed",function(a){this.load(this.options.id,a)},this)},save:function(a){this.sandbox.emit("sulu.header.toolbar.item.loading","save-button"),this.product.set(a),this.product.saveLocale(this.options.locale,{success:function(b){var c=b.toJSON();a.id?this.sandbox.emit("sulu.products.saved",c):this.load(c.id,this.options.locale)}.bind(this),error:function(){this.sandbox.logger.log("error while saving product")}.bind(this)})},load:function(a,b){this.sandbox.emit("sulu.router.navigate","pim/products/"+b+"/edit:"+a+"/details")},renderForm:function(){this.product=new a;var b=this.sandbox.dom.createElement('<div id="products-form-container"/>'),c={name:"products/components/form@suluproduct",options:{el:b,locale:this.options.locale,data:this.product.defaults(),productType:this.options.productType}};this.html(b),this.options.id?(this.product.set({id:this.options.id}),this.product.fetchLocale(this.options.locale,{success:function(a){c.options.data=a.toJSON(),this.sandbox.start([c])}.bind(this)})):this.sandbox.start([c])},renderList:function(){var a=this.sandbox.dom.createElement('<div id="products-list-container"/>');this.html(a),this.sandbox.start([{name:"products/components/list@suluproduct",options:{el:a}}])},renderImport:function(){var a=this.sandbox.dom.createElement('<div id="products-import"/>');this.html(a),this.sandbox.start([{name:"products/components/import@suluproduct",options:{el:a}}])}}});